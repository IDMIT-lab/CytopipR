% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/12_Differential_Testing.R
\name{runDifferentialTesting}
\alias{runDifferentialTesting}
\title{Run Differential Testing}
\usage{
runDifferentialTesting(
  CYTdata,
  clustering,
  clusters = NULL,
  comparisonSpl,
  referenceSplName = NULL,
  differentialTestingTitle = "cmp",
  variable = c("cellcount", "abundance", "marker"),
  NFSValues = NULL,
  marker = NULL,
  comparisonSplFCref = NULL,
  FCrefMethod = c("ratio", "percIncrease"),
  eps = 0.001,
  twogroupTest = c("wilcox.test", "t.test", "permutation.test"),
  moregroupTest = c("kruskal", "ANOVA", "ANOVA.MR", "friedman"),
  posthocTest = c("none", "dunn", "tukey"),
  p.adjust = c("none", "holm", "hochberg", "hommel", "bonferroni", "BH", "BY", "fdr"),
  paired = FALSE,
  verbose = FALSE,
  checkOverwrite = TRUE,
  ...
)
}
\arguments{
\item{CYTdata}{A Cytometry data object containing clustering and sample data.}

\item{clustering}{A string specifying the name of the clustering column to be analyzed.}

\item{clusters}{A vector of cluster labels for the analysis. If NULL, all clusters are used.}

\item{comparisonSpl}{A list of sample groups to compare against each other. Must contain at least two elements.}

\item{referenceSplName}{A string specifying the name of the reference sample group. If NULL, the first group is used.}

\item{differentialTestingTitle}{A string for the title of the differential testing results.}

\item{variable}{A string indicating the type of variable to analyze. Can be one of "cellcount", "abundance", or "marker".}

\item{NFSValues}{A named vector of normalization factor values for visualizations. Used only if variable is "abundance".}

\item{marker}{A string specifying the marker to analyze. Used only if variable is "marker".}

\item{comparisonSplFCref}{A list of sample groups for fold change reference.}

\item{FCrefMethod}{A string specifying the method for calculating fold change. Options are "ratio" or "percIncrease".}

\item{eps}{A small value to avoid division by zero when calculating fold change.}

\item{twogroupTest}{A string specifying the statistical test for two-group comparisons. Options are "wilcox.test", "t.test", or "permutation.test".}

\item{moregroupTest}{A string specifying the statistical test for multi-group comparisons. Options are "kruskal", "ANOVA", "ANOVA.MR", or "friedman".}

\item{posthocTest}{A string specifying the post-hoc test to apply. Options are "none", "dunn", or "tukey".}

\item{p.adjust}{A string specifying the method for adjusting p-values. Options are "none", "holm", "hochberg", "hommel", "bonferroni", "BH", "BY", or "fdr".}

\item{paired}{A logical indicating whether to perform a paired test. Defaults to FALSE.}

\item{verbose}{A logical indicating whether to print verbose messages.}

\item{checkOverwrite}{A logical indicating whether to prompt for overwriting existing differential testing results.}

\item{...}{Additional arguments passed to other functions.}
}
\value{
The updated CYTdata object with differential testing results stored in the `differentialTesting` slot.
        The results include p-values, fold changes, and significance values for each cluster comparison.
}
\description{
This function performs differential testing for cell clustering data based on sample group comparisons.
It supports both two-group and multi-group tests, with options for various statistical tests and post-hoc analyses.
The function computes fold change (FC) and adjusts p-values for multiple testing.
The result is stored in the differential testing data within the CYTdata object.
}
\examples{
# Example for performing differential testing with cell counts
CYTdata <- runDifferentialTesting(CYTdata,
                                  clustering = "ClusterType",
                                  comparisonSpl = list("GroupA" = c("Sample1", "Sample2"),
                                                       "GroupB" = c("Sample3", "Sample4")),
                                  differentialTestingTitle = "Test1",
                                  variable = "cellcount")

# Example for performing differential testing with abundance values
CYTdata <- runDifferentialTesting(CYTdata,
                                  clustering = "ClusterType",
                                  comparisonSpl = list("GroupA" = c("Sample1", "Sample2"),
                                                       "GroupB" = c("Sample3", "Sample4")),
                                  differentialTestingTitle = "Test2",
                                  variable = "abundance",
                                  NFSValues = c(Sample1 = 1.2, Sample2 = 1.1, Sample3 = 0.9, Sample4 = 1.0))

# Example for performing differential testing with a marker
CYTdata <- runDifferentialTesting(CYTdata,
                                  clustering = "ClusterType",
                                  comparisonSpl = list("GroupA" = c("Sample1", "Sample2"),
                                                       "GroupB" = c("Sample3", "Sample4")),
                                  differentialTestingTitle = "Test3",
                                  variable = "marker",
                                  marker = "Marker1")

}
\seealso{
\code{\link{checkorderClustering}} for ordering and checking the clustering data.
}
