% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/11_Cell_Plot.R
\name{plotCells}
\alias{plotCells}
\title{Plot Cells in 2D with Various Colorings}
\usage{
plotCells(
  CYTdata,
  expression = c("DimRed", "markers"),
  DimRed = NULL,
  coupleMarkers = NULL,
  colorBy = c("clustering", "marker", "density", "metadata", "none"),
  clustering = NULL,
  clusters = NULL,
  printClustering = TRUE,
  marker = NULL,
  markerPalette = NULL,
  densityPalette = NULL,
  metadata = "Individual",
  samples = NULL,
  filteringMethod = c("remove", "color"),
  filteringColor = "grey",
  noneColor = "red",
  percentDownsampling = NULL,
  bounds = c(0.05, 0.95),
  plotLinearRegression = FALSE,
  ylim = NULL,
  xlim = NULL
)
}
\arguments{
\item{CYTdata}{An object of class \code{CYTdata} containing cytometry data.}

\item{expression}{A character string specifying the type of expression data to plot. Options are "DimRed" for dimensionality reduction or "markers" for specific marker expressions.}

\item{DimRed}{A string specifying the name of the dimensionality reduction method (e.g., PCA, t-SNE). Used if \code{expression = "DimRed"}.}

\item{coupleMarkers}{A vector of two marker names to compare. Used if \code{expression = "markers"}.}

\item{colorBy}{A character string specifying how to color the plot. Options are "clustering", "marker", "density", "metadata", or "none".}

\item{clustering}{A string specifying the clustering method (used if \code{colorBy = "clustering"}).}

\item{clusters}{A vector of cluster names or indices to include in the plot (used if \code{colorBy = "clustering"}).}

\item{printClustering}{A logical value indicating whether to print the centroids of each cluster on the plot (used if \code{colorBy = "clustering"}).}

\item{marker}{A string specifying the marker to use for coloring the plot (used if \code{colorBy = "marker"}).}

\item{markerPalette}{A vector of colors to be used for marker expression coloring (used if \code{colorBy = "marker"}).}

\item{densityPalette}{A vector of colors for density plot coloring (used if \code{colorBy = "density"}).}

\item{metadata}{A string specifying the metadata column name to use for coloring the plot (used if \code{colorBy = "metadata"}).}

\item{samples}{A vector of sample IDs to include in the plot. Optional.}

\item{filteringMethod}{A string specifying the filtering method to apply. Options are "remove" or "color".}

\item{filteringColor}{The color to use for points that are filtered out (used if \code{filteringMethod = "color"}).}

\item{noneColor}{The color to use for the plot when no coloring is applied (used if \code{colorBy = "none"}).}

\item{percentDownsampling}{A numeric value between 0 and 1 to downsample the data by a given percentage.}

\item{bounds}{A vector of two numeric values representing the quantile bounds for marker expression (used if \code{colorBy = "marker"}).}

\item{plotLinearRegression}{A logical value indicating whether to plot a linear regression line (used if \code{expression = "markers"}).}

\item{ylim}{The y-axis limits for the plot.}

\item{xlim}{The x-axis limits for the plot.}
}
\value{
A \code{ggplot} object representing the 2D plot of cells.
}
\description{
This function creates a 2D plot of cells from cytometry data. It supports visualization of the data in multiple ways, including dimensionality reduction (e.g., PCA or t-SNE), marker expression comparisons, clustering results, density plots, and metadata coloring. The function also allows for downsampling and various customization options such as linear regression plots.
}
\details{
This function provides several ways to visualize the relationship between cells and different features:
- **DimRed**: Displays a dimensionality reduction (e.g., PCA, t-SNE) of the cell data.
- **markers**: Plots the expression of two markers and can color by a selected feature (clustering, metadata, etc.).
- **colorBy options**:
  - **"clustering"**: Colors the points by cluster label, and optionally adds centroids for each cluster.
  - **"marker"**: Colors the points based on marker expression, with optional quantile clipping.
  - **"density"**: Colors the points based on cell density.
  - **"metadata"**: Colors the points based on metadata values.
  - **"none"**: Displays the data with no color applied.

Users can customize the appearance of the plot, downsample the data for better performance, and apply different filtering methods to exclude points.
}
\examples{
# Example usage for DimRed expression with clustering coloring:
plotCells(CYTdata, expression = "DimRed", DimRed = "PCA1", colorBy = "clustering", clustering = "kmeans")

# Example usage for marker expression comparison with density coloring:
plotCells(CYTdata, expression = "markers", coupleMarkers = c("CD4", "CD8"), colorBy = "density")

# Example usage for marker expression with custom color palette:
plotCells(CYTdata, expression = "markers", coupleMarkers = c("CD4", "CD8"), colorBy = "marker", markerPalette = c("blue", "red"))

}
