% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/7_Clustering.R
\name{computeMSI}
\alias{computeMSI}
\title{Compute MSI (Marker or DimRed) for Clusters}
\usage{
computeMSI(
  CYTdata,
  clustering,
  clusters = NULL,
  samples = NULL,
  computeWith = c("markers", "DimRed"),
  markers = NULL,
  DimRed = NULL,
  typeScaling = c("none", "center", "reduced", "center_reduced", "rescale_min_max"),
  rescaleQt = c(0.05, 0.95),
  rescaleBorders = c(0, 1),
  scaleByMetadata = NULL,
  typeMSI = c("median", "mean")
)
}
\arguments{
\item{CYTdata}{A `CYTdata` object containing the clustering and expression data.}

\item{clustering}{A string specifying the name of the clustering column in the `cellClustering` data frame.}

\item{clusters}{A vector of cluster labels (optional). If `NULL`, all clusters from `clustering` will be used.}

\item{samples}{A vector of sample identifiers (optional). If `NULL`, all samples will be used.}

\item{computeWith}{A string specifying whether to compute MSI based on "markers" or "DimRed". Defaults to "markers".}

\item{markers}{A vector of marker names (optional). Used only when `computeWith = "markers"`.}

\item{DimRed}{A string specifying the name of the dimensionality reduction method (optional). Used only when `computeWith = "DimRed"`.}

\item{typeScaling}{A string specifying the type of scaling to apply. Options include:
- `"none"`: No scaling
- `"center"`: Center the data
- `"reduced"`: Apply reduced scaling
- `"center_reduced"`: Apply center and reduced scaling
- `"rescale_min_max"`: Rescale data to min-max scale
Defaults to `"none"`.}

\item{rescaleQt}{A numeric vector of length 2 specifying the quantiles for rescaling. Defaults to `c(0.05, 0.95)`.}

\item{rescaleBorders}{A numeric vector of length 2 specifying the borders for rescaling. Defaults to `c(0, 1)`.}

\item{scaleByMetadata}{A string specifying a sample metadata column to scale by. Defaults to `NULL`, indicating no scaling by metadata.}

\item{typeMSI}{A string specifying whether to compute MSI using the `"mean"` or `"median"` method. Defaults to `"median"`.}
}
\value{
A data frame with MSI values for each cluster, with rows representing clusters and columns representing features.
}
\description{
This function computes the MSI (Median/Mean of Scaled Expression) for each cluster in a specified `clustering` column using either marker expression data or dimensionality reduction (DimRed) data. The function performs scaling of the data and then computes either the median or mean for each cluster's MSI.
}
\details{
The function computes the MSI (either mean or median) for each cluster based on the scaling of either marker expression data or dimensionality reduction (DimRed) data. If scaling by metadata is specified, the data is scaled separately for each metadata group before computing the MSI.

The MSI values are computed for each cluster using the specified `clustering` column. Scaling options allow for different preprocessing steps to ensure that the data is appropriately transformed before computing MSI.
}
\examples{
# Example: Compute MSI for clusters using marker data
msi_values = computeMSI(CYTdata, clustering = "clusterColumn", computeWith = "markers", markers = c("marker1", "marker2"))

# Example: Compute MSI for clusters using DimRed data
msi_values = computeMSI(CYTdata, clustering = "clusterColumn", computeWith = "DimRed", DimRed = "PCA")

}
\seealso{
\code{\link{exprsScaling}} for scaling the expression data, which is used in this function to preprocess data.
}
